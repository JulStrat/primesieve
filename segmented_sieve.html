<!DOCTYPE html>
<html lang="en">
  <head>
    <title>primesieve - Segmented sieve of Eratosthenes</title>

    <meta charset='utf-8'>
    <meta name="description" content="Step by step explanation of the segmented sieve of Eratosthenes with code in C++. Runs much faster than a traditional sieve of Eratosthenes implementation due to its more efficient CPU cache usage.">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- Inline critical CSS for faster page rendering -->
    <style>html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}sup{font-size:x-small;vertical-align:super}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}table{border-collapse:collapse;border-spacing:0}body{font-size:1.1em;line-height:1.55;font-family:'Open Sans',sans-serif;font-weight:100;color:#0d0d0d;background:#fafafa}li{white-space:nowrap}p.binding{padding-top:1em}td.binding_language{font-weight:bold;color:#303030;white-space:nowrap;padding:.35em .7em;border:1px solid #c3c3c3}td.binding_link{white-space:nowrap;padding:.35em .7em;border:1px solid #c3c3c3}td.timing{text-align:right;padding:.35em .7em;border:1px solid #c6c6c6}td.timing_title{text-align:center;font-weight:bold;line-height:1.3em;padding:.8em .8em;color:#303030;border:1px solid #c6c6c6}p.optimizations_title{font-weight:bold;color:#303030}span.cpu_details{white-space:nowrap;font-size:.6em;font-weight:normal}span.programming_language{font-weight:bold}li.hide_overflow{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}a{color:#2476bd}a:hover{text-decoration:underline}header{padding-top:37px;padding-bottom:43px;font-weight:500;background:#2e7bcf url(images/header-bg.jpg) 0 0 repeat-x;border-bottom:solid 1px #275da1}header h1{font-size:4.0em;color:#fff;line-height:1;margin-bottom:.2em;width:540px}header h2{font-size:1.6em;color:#9ddcff;line-height:1.2;width:540px;letter-spacing:0}.inner{position:relative;width:1050px;margin:0 auto}@media screen and (max-width:1100px){#content-wrapper{border-top:solid 1px #fff;padding-top:20px}}@media screen and (min-width:1101px){#content-wrapper{border-top:solid 1px #fff;padding-top:30px}}@media screen and (max-width:850px){#timings_div{display:none}}@media screen and (max-width:700px){#inner_loop_div{display:none}}@media screen and (max-width:700px){.github_gist_script{display:none}}@media screen and (max-width:950px){#references_div{display:none}}#main-content{width:800px;float:left}#main-content img{max-width:100%}aside#sidebar{width:200px;padding-left:20px;min-height:504px;float:right;background:transparent url(images/sidebar-bg.jpg) 0 0 no-repeat;font-size:.75em;line-height:1.4}aside#sidebar p.repo-owner,aside#sidebar p.repo-owner a{font-weight:bold}a.button{width:134px;height:58px;line-height:1.25;font-weight:400;font-size:23px;color:#fff;padding-left:68px;padding-top:20px;padding-bottom:2px;text-decoration:none}a.button small{display:block;font-weight:400;font-size:.6em}header a.button{position:absolute;right:0;top:20px;background:transparent url(images/github-button.png) 0 0 no-repeat}aside a.button{width:138px;padding-left:64px;display:block;background:transparent url(images/download-button.png) 0 0 no-repeat;font-size:21px;margin-bottom:1.0em}ul,ol,dl{margin-bottom:20px}table{width:100%;border:1px solid #c6c6c6}th{font-weight:500}form{background:#f2f2f2;padding:20px}#main-content h2{font-size:1.7em;font-weight:bold;padding-top:.5em;margin-bottom:.5em;color:#303030}p{margin-bottom:20px}a{text-decoration:none}p a{font-weight:400}blockquote{font-size:1.6em;border-left:10px solid #e9e9e9;margin-bottom:20px;padding:0 0 0 30px}ul{list-style:disc outside none;padding-left:37px}ol{list-style:decimal inside;padding-left:3px}dl dd{font-style:italic;font-weight:100}footer{margin-top:40px;padding-top:20px;padding-bottom:30px;font-size:13px;color:#aaa}footer a{color:#0d0d0d}footer a:hover{color:#444}.clearfix:after{clear:both;content:'.';display:block;visibility:hidden;height:0}.clearfix{display:inline-block}* html .clearfix{height:1%}.clearfix{display:block}@media only screen and (max-width:950px){.inner{width:93%}header{padding:20px 0}header .inner{position:relative}header h1,header h2{width:100%}header h1{font-size:48px}header h2{font-size:24px}header a.button{background-image:none;width:auto;height:auto;display:inline-block;margin-top:15px;padding:5px 10px;position:relative;text-align:center;font-family:'Open Sans',sans-serif;font-size:13px;font-weight:400;line-height:1;background-color:#9cd6ff;color:#2879d0;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;top:0}header a.button small{font-family:'Open Sans',sans-serif;font-size:13px;font-weight:400;display:inline}#main-content,aside#sidebar{float:none;width:100%!important}aside#sidebar{background-image:none;margin-top:20px;border-top:solid 1px #ddd;padding:20px 0;min-height:0}aside#sidebar a.button{display:none}}figure{box-sizing:border-box;width:580px;margin:0;line-height:1.1;display:-webkit-box;display:-ms-flexbox;display:flex;background:#fff;color:#222831;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}.terminal_header{letter-spacing:.2em;font-weight:bold;font-size:40px;text-indent:.4em;color:#9c9fa3;background:#cecfd1;line-height:30px;height:31px;border-top-left-radius:.15em;border-top-right-radius:.15em;border:1px solid #d7d8da;border-bottom:0;box-shadow:0 .4em 1em rgba(57,62,70,.25);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.terminal_body{font-family:Menlo,Consolas,Monaco,Courier New,Courier,monospace;font-size:.93em;line-height:1.3;margin-bottom:1.5em;padding:1.2em 1.15em 1.5em;border:1px solid #d7d8da;border-bottom-left-radius:.4em;border-bottom-right-radius:.4em;border-top:0;box-shadow:0 .4em 1em rgba(57,62,70,.25);background-color:#393e46}.terminal_body .highlight{margin:0;padding:0;background-color:initial;color:#f2f2f2}@media screen and (max-width:1100px){#nav_div{display:none}}@media screen and (max-width:1100px){#nav_ul{display:none}}#navigation{font-family:'Open Sans',sans-serif;font-size:.82em;font-weight:bold;text-transform:uppercase;color:#303030;width:1000px;margin-bottom:1.9em}#navigation:after{clear:both;content:".";display:block;height:0;visibility:hidden}#navigation ul{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent;list-style:none;float:left;border-radius:100px;box-shadow:0 2px 2px rgba(0,0,0,0.07);-webkit-box-shadow:0 2px 2px rgba(0,0,0,0.07);overflow:hidden}#navigation li{float:left;border-style:solid;border-width:1px;border-color:#aaa #aaa #aaa #FFF;box-shadow:0 1px rgba(255,255,255,1) inset;-webkit-box-shadow:0 1px rgba(255,255,255,1) inset;background:#f7f7f7;background:-moz-linear-gradient(top,#f7f7f7 0,#ededed 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#f7f7f7),color-stop(100%,#ededed));background:-webkit-linear-gradient(top,#f7f7f7 0,#ededed 100%);background:-o-linear-gradient(top,#f7f7f7 0,#ededed 100%);background:-ms-linear-gradient(top,#f7f7f7 0,#ededed 100%);background:linear-gradient(to bottom,#f7f7f7 0,#ededed 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#F7F7F7',endColorstr='#EDEDED',GradientType=0)}#navigation li:hover,#navigation li.current{box-shadow:0 1px rgba(255,255,255,0.2) inset;-webkit-box-shadow:0 1px rgba(255,255,255,0.2) inset;border-color:#262626!important;background:#4d4d4d;background:-moz-linear-gradient(top,#4d4d4d 0,#262626 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#4d4d4d),color-stop(100%,#262626));background:-webkit-linear-gradient(top,#4d4d4d 0,#262626 100%);background:-o-linear-gradient(top,#4d4d4d 0,#262626 100%);background:-ms-linear-gradient(top,#4d4d4d 0,#262626 100%);background:linear-gradient(to bottom,#4d4d4d 0,#262626 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#4D4D4D',endColorstr='#262626',GradientType=0)}#navigation a{display:block;padding:.75em 1.05em;color:#303030;text-decoration:none;text-shadow:0 1px #FFF}#navigation a:hover,#navigation li.current a{color:#FFF;text-shadow:0 1px #000}#navigation li:first-child{border-left-color:#aaa;border-radius:100px 0 0 100px}#navigation li:last-child{border-radius:0 100px 100px 0}</style>

    <link rel="preload" as="script" href="https://api.github.com/repos/kimwalisch/primesieve?callback=callback">
    <link rel="preload" as="image" href="images/header-bg.jpg">
    <link rel="preload" as="image" href="images/sidebar-bg.jpg" media="(min-width: 950px)">
    <link rel="preload" as="image" href="images/github-button.png" media="(min-width: 950px)">
    <link rel="preload" as="image" href="images/download-button.png" media="(min-width: 950px)">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700">
    <link rel="shortcut icon" href="images/primesieve.ico">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-47069346-1', 'primesieve.org');
      ga('send', 'pageview');
    </script>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>primesieve</h1>
        <h2>Fast C/C++ prime number generator</h2>
        <a href="https://github.com/kimwalisch/primesieve" class="button"><small>View project on </small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">

<div id="nav_div">
  <nav id="navigation">
    <ul id="nav_ul">
      <li><a href=".">&nbsp;Home</a></li>
      <li><a href="downloads">Downloads</a></li>
      <li><a href="screenshots.html">Screenshots</a></li>
      <li><a href="segmented_sieve.html">Segmented Sieve</a></li>
      <li><a href="api">API Documentation</a></li>
      <li><a href="links.html">Links&nbsp;</a></li>
    </ul>
  </nav>
</div>

<h2><a id="segmented-sieve"></a>Segmented sieve of Eratosthenes</h2>
<p>This page contains a step by step explanation of a simple but fast
C++ implementation of the segmented sieve of Eratosthenes that
generates the primes below n using
<img src="images/Onloglogn.svg" alt="O(n log log n)" style="height: 1.2em; width: auto; vertical-align: middle;"/>
operations and
<img src="images/Osqrtn.svg" alt="O(sqrt(n))" style="height: 1.2em; width: auto; vertical-align: middle;"/>
space. It runs significantly faster than a
<a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes#Algorithm_and_variants">traditional
sieve of Eratosthenes implementation</a> due to its more efficient
CPU cache usage i.e. it uses the CPU's L1 data cache size as its sieve
array size. This ensures that less than 1 percent of the memory
accesses will be cache misses. This implementation generates the
primes below 10^9 in just 0.8 seconds (single-threaded) on an Intel
Core i7-6700 3.4 GHz CPU.</p>

<h2><a id="initialization"></a>Initialization</h2>
<p>We set the size of the sieve array named segment_size to be the
same size as the CPU's L1 data cache size per core e.g. 32768 bytes.
The segment size must not be smaller than the square root of the
sieving limit otherwise the run-time complexity of the algorithm
deteriorates.</p>
<link rel="stylesheet" href="stylesheets/gist-embed-357067cd85e7.css">
<script>
document.write('<div id=\"gist87731363\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve1-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ Set your CPU&#39;s L1 data cache size (in bytes) here<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const<\/span> <span class=\"pl-c1\">int64_t<\/span> L1D_CACHE_SIZE = <span class=\"pl-c1\">32768<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ Generate primes using the segmented sieve of Eratosthenes.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ This algorithm uses O(n log log n) operations and O(sqrt(n)) space.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @param limit  Sieve primes &lt;= limit.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">void<\/span> <span class=\"pl-en\">segmented_sieve<\/span>(<span class=\"pl-c1\">int64_t<\/span> limit)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC9\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC10\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> <span class=\"pl-c1\">sqrt<\/span> = (<span class=\"pl-c1\">int64_t<\/span>) <span class=\"pl-c1\">std::sqrt<\/span>(limit);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve1-cpp-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"><\/td>\n        <td id=\"file-segmented_sieve1-cpp-LC11\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> segment_size = <span class=\"pl-c1\">std::max<\/span>(<span class=\"pl-c1\">sqrt<\/span>, L1D_CACHE_SIZE);<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/28b1308ecbf33260bb2e243fab3459b0/raw/6eb4402e546a7c01df21aca2f934b835dfa12959/segmented_sieve1.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/28b1308ecbf33260bb2e243fab3459b0#file-segmented_sieve1-cpp\">segmented_sieve1.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="outer-sieving-loop"></a>Outer sieving loop</h2>
<p>We sieve one segment in each iteration of the outer sieving loop.
At the beginning of each iteration we reset the sieve array
and set the lower and upper bounds of the current segment. Hence
the current segment corresponds to the interval [low,&nbsp;high].</p>
<script>
document.write('<div id=\"gist87732156\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve2-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> low = <span class=\"pl-c1\">0<\/span>; low &lt;= limit; low += segment_size)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">std::fill<\/span>(sieve.<span class=\"pl-c1\">begin<\/span>(), sieve.<span class=\"pl-c1\">end<\/span>(), <span class=\"pl-c1\">true<\/span>);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> current segment = [low, high]<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> high = low + segment_size - <span class=\"pl-c1\">1<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve2-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_sieve2-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\">  high = <span class=\"pl-c1\">std::min<\/span>(high, limit);<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/57e0440fb568dfe4be3865f26f566f7d/raw/1d11d34b5ccc4f45ad2c207fa7fcb6f8a4483717/segmented_sieve2.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/57e0440fb568dfe4be3865f26f566f7d#file-segmented_sieve2-cpp\">segmented_sieve2.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="sieving-primes"></a>Generate sieving primes</h2>
<p>Before we can start sieving the current segment [low,&nbsp;high]
we need to generate the sieving primes ≤ sqrt(high). We do this using
a simple sieve of Eratosthenes implementation. When we find a new
sieving prime we store it in the primes array and we also store the
index of the first multiple that needs to be crossed off (in the
segmented sieve) in the multiples array.</p>
<script>
document.write('<div id=\"gist87732590\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve3-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> generate sieving primes using simple sieve of Eratosthenes<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (; i * i &lt;= high; i += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">if<\/span> (is_prime[i])<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> j = i * i; j &lt;= sqrt; j += i)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\">      is_prime[j] = <span class=\"pl-c1\">false<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> initialize sieving primes for segmented sieve<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (; s * s &lt;= high; s += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC9\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC10\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">if<\/span> (is_prime[s])<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC11\" class=\"blob-code blob-code-inner js-file-line\">  {<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC12\" class=\"blob-code blob-code-inner js-file-line\">       primes.<span class=\"pl-c1\">push_back<\/span>(s);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC13\" class=\"blob-code blob-code-inner js-file-line\">    multiples.<span class=\"pl-c1\">push_back<\/span>(s * s - low);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC14\" class=\"blob-code blob-code-inner js-file-line\">  }<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve3-cpp-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"><\/td>\n        <td id=\"file-segmented_sieve3-cpp-LC15\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/9b8a2c2f5a64dfe63c56668b4fe7d8b2/raw/d7a00863e20c728587db2b728f26023c36aa99d1/segmented_sieve3.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/9b8a2c2f5a64dfe63c56668b4fe7d8b2#file-segmented_sieve3-cpp\">segmented_sieve3.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="sieve-a-segment"></a>Sieve a segment</h2>
<p>After having generated the sieving primes we can proceed with the
actual prime sieving. We start crossing off the multiples of the first
sieving prime 3 until we reach a multiple of 3 ≥ segment_size, when
this happens we calculate the index of that multiple in the next
segment using (multiple&nbsp;-&nbsp;segment_size) and store it in the
multiples array. We then cross off the multiples of the other sieving
primes using the same procedure.</p>
<script>
document.write('<div id=\"gist87732827\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve4-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> sieve the current segment<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (std::<span class=\"pl-c1\">size_t<\/span> i = <span class=\"pl-c1\">0<\/span>; i &lt; primes.size(); i++)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> j = multiples[i];<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> k = primes[i] * <span class=\"pl-c1\">2<\/span>; j &lt; segment_size; j += k)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\">    sieve[j] = <span class=\"pl-c1\">false<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\">  multiples[i] = j - segment_size;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve4-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_sieve4-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/df7dddbb1676969cb08e9c495181384a/raw/ebc390c626f51277b66215e16210ae86bb527887/segmented_sieve4.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/df7dddbb1676969cb08e9c495181384a#file-segmented_sieve4-cpp\">segmented_sieve4.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="identify-primes"></a>Identify primes</h2>
<p>Once we have crossed off the multiples of all sieving primes in the
current segment we iterate over the sieve array and count (or print)
the primes.</p>
<script>
document.write('<div id=\"gist87732961\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve5-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve5-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve5-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (; n &lt;= high; n += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve5-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve5-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">if<\/span> (sieve[n - low]) <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> n is a prime<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve5-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve5-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">    count++;<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/3d709ae746a894e3e98723a0fe42864c/raw/0e442b45467658537ddd1039696039a5381352f5/segmented_sieve5.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/3d709ae746a894e3e98723a0fe42864c#file-segmented_sieve5-cpp\">segmented_sieve5.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="complete-sieve"></a>Putting it all together</h2>
<script>
document.write('<div id=\"gist21332472\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_sieve-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @file     segmented_sieve.cpp<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @author   Kim Walisch, &lt;kim.walisch@gmail.com&gt; <\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @brief    This is a simple implementation of the segmented sieve of<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/           Eratosthenes with a few optimizations. It generates the<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/           primes below 10^9 in 0.8 seconds (single-threaded) on an<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/           Intel Core i7-6700 3.4 GHz CPU.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @license  Public domain.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC9\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>iostream<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC10\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>algorithm<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L11\" class=\"blob-num js-line-number\" data-line-number=\"11\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC11\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>cmath<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L12\" class=\"blob-num js-line-number\" data-line-number=\"12\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC12\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>vector<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L13\" class=\"blob-num js-line-number\" data-line-number=\"13\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC13\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>cstdlib<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L14\" class=\"blob-num js-line-number\" data-line-number=\"14\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC14\" class=\"blob-code blob-code-inner js-file-line\">#<span class=\"pl-k\">include<\/span> <span class=\"pl-s\"><span class=\"pl-pds\">&lt;<\/span>stdint.h<span class=\"pl-pds\">&gt;<\/span><\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L15\" class=\"blob-num js-line-number\" data-line-number=\"15\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC15\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L16\" class=\"blob-num js-line-number\" data-line-number=\"16\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC16\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ Set your CPU&#39;s L1 data cache size (in bytes) here<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L17\" class=\"blob-num js-line-number\" data-line-number=\"17\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC17\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">const<\/span> <span class=\"pl-c1\">int64_t<\/span> L1D_CACHE_SIZE = <span class=\"pl-c1\">32768<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L18\" class=\"blob-num js-line-number\" data-line-number=\"18\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC18\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L19\" class=\"blob-num js-line-number\" data-line-number=\"19\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC19\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ Generate primes using the segmented sieve of Eratosthenes.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L20\" class=\"blob-num js-line-number\" data-line-number=\"20\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC20\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ This algorithm uses O(n log log n) operations and O(sqrt(n)) space.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L21\" class=\"blob-num js-line-number\" data-line-number=\"21\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC21\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @param limit  Sieve primes &lt;= limit.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L22\" class=\"blob-num js-line-number\" data-line-number=\"22\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC22\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L23\" class=\"blob-num js-line-number\" data-line-number=\"23\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC23\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">void<\/span> <span class=\"pl-en\">segmented_sieve<\/span>(<span class=\"pl-c1\">int64_t<\/span> limit)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L24\" class=\"blob-num js-line-number\" data-line-number=\"24\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC24\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L25\" class=\"blob-num js-line-number\" data-line-number=\"25\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC25\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> <span class=\"pl-c1\">sqrt<\/span> = (<span class=\"pl-c1\">int64_t<\/span>) <span class=\"pl-c1\">std::sqrt<\/span>(limit);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L26\" class=\"blob-num js-line-number\" data-line-number=\"26\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC26\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> segment_size = <span class=\"pl-c1\">std::max<\/span>(<span class=\"pl-c1\">sqrt<\/span>, L1D_CACHE_SIZE);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L27\" class=\"blob-num js-line-number\" data-line-number=\"27\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC27\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> count = (limit &lt; <span class=\"pl-c1\">2<\/span>) ? <span class=\"pl-c1\">0<\/span> : <span class=\"pl-c1\">1<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L28\" class=\"blob-num js-line-number\" data-line-number=\"28\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC28\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L29\" class=\"blob-num js-line-number\" data-line-number=\"29\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC29\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> we sieve primes &gt;= 3<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L30\" class=\"blob-num js-line-number\" data-line-number=\"30\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC30\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> i = <span class=\"pl-c1\">3<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L31\" class=\"blob-num js-line-number\" data-line-number=\"31\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC31\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> n = <span class=\"pl-c1\">3<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L32\" class=\"blob-num js-line-number\" data-line-number=\"32\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC32\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> s = <span class=\"pl-c1\">3<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L33\" class=\"blob-num js-line-number\" data-line-number=\"33\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC33\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L34\" class=\"blob-num js-line-number\" data-line-number=\"34\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC34\" class=\"blob-code blob-code-inner js-file-line\">  std::vector&lt;<span class=\"pl-k\">char<\/span>&gt; <span class=\"pl-c1\">sieve<\/span>(segment_size);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L35\" class=\"blob-num js-line-number\" data-line-number=\"35\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC35\" class=\"blob-code blob-code-inner js-file-line\">  std::vector&lt;<span class=\"pl-k\">char<\/span>&gt; <span class=\"pl-c1\">is_prime<\/span>(<span class=\"pl-c1\">sqrt<\/span> + <span class=\"pl-c1\">1<\/span>, <span class=\"pl-c1\">true<\/span>);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L36\" class=\"blob-num js-line-number\" data-line-number=\"36\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC36\" class=\"blob-code blob-code-inner js-file-line\">  std::vector&lt;<span class=\"pl-c1\">int64_t<\/span>&gt; primes;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L37\" class=\"blob-num js-line-number\" data-line-number=\"37\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC37\" class=\"blob-code blob-code-inner js-file-line\">  std::vector&lt;<span class=\"pl-c1\">int64_t<\/span>&gt; multiples;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L38\" class=\"blob-num js-line-number\" data-line-number=\"38\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC38\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L39\" class=\"blob-num js-line-number\" data-line-number=\"39\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC39\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> low = <span class=\"pl-c1\">0<\/span>; low &lt;= limit; low += segment_size)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L40\" class=\"blob-num js-line-number\" data-line-number=\"40\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC40\" class=\"blob-code blob-code-inner js-file-line\">  {<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L41\" class=\"blob-num js-line-number\" data-line-number=\"41\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC41\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">std::fill<\/span>(sieve.<span class=\"pl-c1\">begin<\/span>(), sieve.<span class=\"pl-c1\">end<\/span>(), <span class=\"pl-c1\">true<\/span>);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L42\" class=\"blob-num js-line-number\" data-line-number=\"42\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC42\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L43\" class=\"blob-num js-line-number\" data-line-number=\"43\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC43\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> current segment = [low, high]<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L44\" class=\"blob-num js-line-number\" data-line-number=\"44\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC44\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">int64_t<\/span> high = low + segment_size - <span class=\"pl-c1\">1<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L45\" class=\"blob-num js-line-number\" data-line-number=\"45\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC45\" class=\"blob-code blob-code-inner js-file-line\">    high = <span class=\"pl-c1\">std::min<\/span>(high, limit);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L46\" class=\"blob-num js-line-number\" data-line-number=\"46\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC46\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L47\" class=\"blob-num js-line-number\" data-line-number=\"47\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC47\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> generate sieving primes using simple sieve of Eratosthenes<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L48\" class=\"blob-num js-line-number\" data-line-number=\"48\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC48\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">for<\/span> (; i * i &lt;= high; i += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L49\" class=\"blob-num js-line-number\" data-line-number=\"49\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC49\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-k\">if<\/span> (is_prime[i])<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L50\" class=\"blob-num js-line-number\" data-line-number=\"50\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC50\" class=\"blob-code blob-code-inner js-file-line\">        <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> j = i * i; j &lt;= <span class=\"pl-c1\">sqrt<\/span>; j += i)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L51\" class=\"blob-num js-line-number\" data-line-number=\"51\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC51\" class=\"blob-code blob-code-inner js-file-line\">          is_prime[j] = <span class=\"pl-c1\">false<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L52\" class=\"blob-num js-line-number\" data-line-number=\"52\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC52\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L53\" class=\"blob-num js-line-number\" data-line-number=\"53\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC53\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> initialize sieving primes for segmented sieve<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L54\" class=\"blob-num js-line-number\" data-line-number=\"54\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC54\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">for<\/span> (; s * s &lt;= high; s += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L55\" class=\"blob-num js-line-number\" data-line-number=\"55\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC55\" class=\"blob-code blob-code-inner js-file-line\">    {<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L56\" class=\"blob-num js-line-number\" data-line-number=\"56\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC56\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-k\">if<\/span> (is_prime[s])<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L57\" class=\"blob-num js-line-number\" data-line-number=\"57\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC57\" class=\"blob-code blob-code-inner js-file-line\">      {<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L58\" class=\"blob-num js-line-number\" data-line-number=\"58\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC58\" class=\"blob-code blob-code-inner js-file-line\">           primes.<span class=\"pl-c1\">push_back<\/span>(s);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L59\" class=\"blob-num js-line-number\" data-line-number=\"59\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC59\" class=\"blob-code blob-code-inner js-file-line\">        multiples.<span class=\"pl-c1\">push_back<\/span>(s * s - low);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L60\" class=\"blob-num js-line-number\" data-line-number=\"60\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC60\" class=\"blob-code blob-code-inner js-file-line\">      }<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L61\" class=\"blob-num js-line-number\" data-line-number=\"61\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC61\" class=\"blob-code blob-code-inner js-file-line\">    }<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L62\" class=\"blob-num js-line-number\" data-line-number=\"62\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC62\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L63\" class=\"blob-num js-line-number\" data-line-number=\"63\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC63\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> sieve the current segment<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L64\" class=\"blob-num js-line-number\" data-line-number=\"64\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC64\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">for<\/span> (std::<span class=\"pl-c1\">size_t<\/span> i = <span class=\"pl-c1\">0<\/span>; i &lt; primes.<span class=\"pl-c1\">size<\/span>(); i++)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L65\" class=\"blob-num js-line-number\" data-line-number=\"65\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC65\" class=\"blob-code blob-code-inner js-file-line\">    {<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L66\" class=\"blob-num js-line-number\" data-line-number=\"66\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC66\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-c1\">int64_t<\/span> j = multiples[i];<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L67\" class=\"blob-num js-line-number\" data-line-number=\"67\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC67\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> k = primes[i] * <span class=\"pl-c1\">2<\/span>; j &lt; segment_size; j += k)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L68\" class=\"blob-num js-line-number\" data-line-number=\"68\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC68\" class=\"blob-code blob-code-inner js-file-line\">        sieve[j] = <span class=\"pl-c1\">false<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L69\" class=\"blob-num js-line-number\" data-line-number=\"69\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC69\" class=\"blob-code blob-code-inner js-file-line\">      multiples[i] = j - segment_size;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L70\" class=\"blob-num js-line-number\" data-line-number=\"70\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC70\" class=\"blob-code blob-code-inner js-file-line\">    }<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L71\" class=\"blob-num js-line-number\" data-line-number=\"71\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC71\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L72\" class=\"blob-num js-line-number\" data-line-number=\"72\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC72\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-k\">for<\/span> (; n &lt;= high; n += <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L73\" class=\"blob-num js-line-number\" data-line-number=\"73\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC73\" class=\"blob-code blob-code-inner js-file-line\">      <span class=\"pl-k\">if<\/span> (sieve[n - low]) <span class=\"pl-c\"><span class=\"pl-c\">//<\/span> n is a prime<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L74\" class=\"blob-num js-line-number\" data-line-number=\"74\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC74\" class=\"blob-code blob-code-inner js-file-line\">        count++;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L75\" class=\"blob-num js-line-number\" data-line-number=\"75\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC75\" class=\"blob-code blob-code-inner js-file-line\">  }<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L76\" class=\"blob-num js-line-number\" data-line-number=\"76\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC76\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L77\" class=\"blob-num js-line-number\" data-line-number=\"77\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC77\" class=\"blob-code blob-code-inner js-file-line\">  std::cout &lt;&lt; count &lt;&lt; <span class=\"pl-s\"><span class=\"pl-pds\">&quot;<\/span> primes found.<span class=\"pl-pds\">&quot;<\/span><\/span> &lt;&lt; std::endl;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L78\" class=\"blob-num js-line-number\" data-line-number=\"78\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC78\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L79\" class=\"blob-num js-line-number\" data-line-number=\"79\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC79\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L80\" class=\"blob-num js-line-number\" data-line-number=\"80\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC80\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ Usage: ./segmented_sieve n<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L81\" class=\"blob-num js-line-number\" data-line-number=\"81\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC81\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/ @param n  Sieve the primes up to n.<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L82\" class=\"blob-num js-line-number\" data-line-number=\"82\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC82\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span>/<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L83\" class=\"blob-num js-line-number\" data-line-number=\"83\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC83\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">int<\/span> <span class=\"pl-en\">main<\/span>(<span class=\"pl-k\">int<\/span> argc, <span class=\"pl-k\">char<\/span>** argv)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L84\" class=\"blob-num js-line-number\" data-line-number=\"84\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC84\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L85\" class=\"blob-num js-line-number\" data-line-number=\"85\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC85\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">if<\/span> (argc &gt;= <span class=\"pl-c1\">2<\/span>)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L86\" class=\"blob-num js-line-number\" data-line-number=\"86\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC86\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">segmented_sieve<\/span>(<span class=\"pl-c1\">std::atol<\/span>(argv[<span class=\"pl-c1\">1<\/span>]));<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L87\" class=\"blob-num js-line-number\" data-line-number=\"87\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC87\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">else<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L88\" class=\"blob-num js-line-number\" data-line-number=\"88\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC88\" class=\"blob-code blob-code-inner js-file-line\">    <span class=\"pl-c1\">segmented_sieve<\/span>(<span class=\"pl-c1\">1000000000<\/span>);<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L89\" class=\"blob-num js-line-number\" data-line-number=\"89\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC89\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L90\" class=\"blob-num js-line-number\" data-line-number=\"90\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC90\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">return<\/span> <span class=\"pl-c1\">0<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_sieve-cpp-L91\" class=\"blob-num js-line-number\" data-line-number=\"91\"><\/td>\n        <td id=\"file-segmented_sieve-cpp-LC91\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/3dc39786fab8d5b34fee/raw/38c90b598a61714f66789d12165ff0849bd331a4/segmented_sieve.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/3dc39786fab8d5b34fee#file-segmented_sieve-cpp\">segmented_sieve.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="build-and-run"></a>How to run it</h2>
<p>Download <a href="segmented_sieve.cpp" download>segmented_sieve.cpp</a>, open a terminal and run:</p>

<figure class="terminal_header">&#8226;&#8226;&#8226;</figure>
<figure class="terminal_body">
<pre class="highlight">
<span style="color: #49b2ff;"># Compile using default C++ compiler</span>
c++ -O3 segmented_sieve.cpp -o segmented_sieve

<span style="color: #49b2ff;"># Count the primes below 10^9</span>
time ./segmented_sieve 1000000000
</pre>
</figure>

<h2><a id="bit-array"></a>Using a bit array</h2>
<p>The segmented sieve of Eratosthenes implementation presented before
is both simple and fast. But what if we wanted to further optimize it so that
it runs even faster? Well the next step is to change our implementation
so that it uses a bit array instead of a byte array for sieving.</p>
<p>The idea is to map numbers to bits in the sieve array e.g.
we define that each bit in the sieve array corresponds to an odd
number. Hence bit0&nbsp;=&nbsp;1, bit1&nbsp;=&nbsp;3, bit2&nbsp;=&nbsp;5,
bit3&nbsp;=&nbsp;7 and so forth. This also means that each byte of the sieve
array corresponds to a interval, as each byte has 8 bits
byte0&nbsp;=&nbsp;[0,&nbsp;15], byte1&nbsp;=&nbsp;[16,&nbsp;31],
byte2&nbsp;=&nbsp;[32,&nbsp;47] and so forth.</p>

<h2><a id="segmented-bit-sieve"></a>Segmented bit sieving</h2>
<p>This loop is very similar to the segmented byte sieving loop. But
here when we cross off a multiple we unset the corresponding bit instead
of setting the corresponding byte to false. We divide the multiple by
16 (right shift by 4) to find the corresponding byte and we use the
unset_bit lookup table to mask off the bit corresponding to the
multiple in the sieve array.</p>
<script>
document.write('<div id=\"gist87805949\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_bit_sieve1-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> sieve segment using bit array<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (std::<span class=\"pl-c1\">size_t<\/span> i = <span class=\"pl-c1\">0<\/span>; i &lt; primes.size(); i++)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> j = multiples[i];<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> k = primes[i] * <span class=\"pl-c1\">2<\/span>; j &lt; segment_size; j += k)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\">    sieve[j &gt;&gt; <span class=\"pl-c1\">4<\/span>] &amp;= unset_bit[j &amp; <span class=\"pl-c1\">15<\/span>];<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\">  multiples[i] = j - segment_size;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve1-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_bit_sieve1-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/77553c9dbd2e67e3961a722c9d23e958/raw/77d095d75011c4ff13f225fd9884fe53e6c31667/segmented_bit_sieve1.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/77553c9dbd2e67e3961a722c9d23e958#file-segmented_bit_sieve1-cpp\">segmented_bit_sieve1.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="counting-bits"></a>Counting bits</h2>
<p>Each 1 bit that remains in our sieve array after the sieving step
corresponds to a prime. Instead of iterating over each bit and checking
whether it is set or not we will use a precomputed popcnt lookup table
that tells us how many bits are set in each byte, this is much faster.</p>
<p>We also need to unset the bits in the sieve array that correspond to
numbers > sieving limit. These are the most significant bits in the
last byte of the sieve array.</p>
<script>
document.write('<div id=\"gist87808872\" class=\"gist\">\n    <div class=\"gist-file\">\n      <div class=\"gist-data\">\n        <div class=\"js-gist-file-update-container js-task-list-container file-box\">\n  <div id=\"file-segmented_bit_sieve2-cpp\" class=\"file\">\n    \n\n  <div itemprop=\"text\" class=\"blob-wrapper data type-c\">\n      <table class=\"highlight tab-size js-file-line-container\" data-tab-size=\"8\">\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L1\" class=\"blob-num js-line-number\" data-line-number=\"1\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC1\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> unset bits &gt; limit<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L2\" class=\"blob-num js-line-number\" data-line-number=\"2\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC2\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">if<\/span> (high == limit)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L3\" class=\"blob-num js-line-number\" data-line-number=\"3\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC3\" class=\"blob-code blob-code-inner js-file-line\">{<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L4\" class=\"blob-num js-line-number\" data-line-number=\"4\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC4\" class=\"blob-code blob-code-inner js-file-line\">  <span class=\"pl-c1\">int64_t<\/span> bits = <span class=\"pl-c1\">0xff<\/span> &lt;&lt; (limit % <span class=\"pl-c1\">16<\/span> + <span class=\"pl-c1\">1<\/span>) / <span class=\"pl-c1\">2<\/span>;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L5\" class=\"blob-num js-line-number\" data-line-number=\"5\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC5\" class=\"blob-code blob-code-inner js-file-line\">  sieve[sieve_size - <span class=\"pl-c1\">1<\/span>] &amp;= ~bits;<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L6\" class=\"blob-num js-line-number\" data-line-number=\"6\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC6\" class=\"blob-code blob-code-inner js-file-line\">}<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L7\" class=\"blob-num js-line-number\" data-line-number=\"7\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC7\" class=\"blob-code blob-code-inner js-file-line\">\n<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L8\" class=\"blob-num js-line-number\" data-line-number=\"8\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC8\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-c\"><span class=\"pl-c\">//<\/span> count primes<\/span><\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L9\" class=\"blob-num js-line-number\" data-line-number=\"9\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC9\" class=\"blob-code blob-code-inner js-file-line\"><span class=\"pl-k\">for<\/span> (<span class=\"pl-c1\">int64_t<\/span> n = <span class=\"pl-c1\">0<\/span>; n &lt; sieve_size; n++)<\/td>\n      <\/tr>\n      <tr>\n        <td id=\"file-segmented_bit_sieve2-cpp-L10\" class=\"blob-num js-line-number\" data-line-number=\"10\"><\/td>\n        <td id=\"file-segmented_bit_sieve2-cpp-LC10\" class=\"blob-code blob-code-inner js-file-line\">  count += popcnt[sieve[n]];<\/td>\n      <\/tr>\n<\/table>\n\n\n  <\/div>\n\n  <\/div>\n  \n<\/div>\n\n      <\/div>\n      <div class=\"gist-meta\">\n        <a href=\"https://gist.github.com/kimwalisch/4c0703e97f3594dcb9b9ed83e55852a4/raw/e726f21fca8bf06487a63eba967fab1a24dc9326/segmented_bit_sieve2.cpp\" style=\"float:right\">view raw<\/a>\n        <a href=\"https://gist.github.com/kimwalisch/4c0703e97f3594dcb9b9ed83e55852a4#file-segmented_bit_sieve2-cpp\">segmented_bit_sieve2.cpp<\/a>\n        hosted with &#10084; by <a href=\"https://github.com\">GitHub<\/a>\n      <\/div>\n    <\/div>\n<\/div>\n')
</script>

<h2><a id="run-segmented-bit-sieve"></a>Run the segmented bit sieve</h2>
<p>Download <a href="segmented_bit_sieve.cpp" download>segmented_bit_sieve.cpp</a>, open a terminal and run:</p>

<figure class="terminal_header">&#8226;&#8226;&#8226;</figure>
<figure class="terminal_body">
<pre class="highlight">
<span style="color: #49b2ff;"># Compile using default C++ compiler</span>
c++ -O3 segmented_bit_sieve.cpp -o segmented_bit_sieve

<span style="color: #49b2ff;"># Count the primes below 10^9</span>
time ./segmented_bit_sieve 1000000000
</pre>
</figure>

<h2><a id="faster-bit-sieving"></a>Why is bit sieving faster?</h2>
<p>The performance of the segmented sieve of Eratosthenes mainly
depends on CPU caching. If the sieve array fits into the CPU's L1 or
L2 cache sieving will be extremely fast, if however the sieve array
is larger than the CPU's cache size the sieving performance
will deteriorate by up to 2 orders of magnitude. As the size of the
sieve array is set to the square root of the sieving limit the sieve
array will not fit into the CPU's cache if the sieving limit is
sufficiently large e.g. 10^10.</p>
<p>By using a bit array for sieving the sieve array uses less
memory and hence it will fit into the CPU's caches even for larger
sieving limits. Actually the bit sieving array will fit into the CPU's
L1 cache up to ~&nbsp;10^11.4 and into the CPU's L2 cache up to
~&nbsp;10^13.8.</p>

<h2 style="padding-bottom: 0.2em"><a id="timings"></a>Timings</h2>
<table style="width: 750px;">
<tr>
    <td class="timing_title">x</td>
    <td class="timing_title">
      <span style="white-space: nowrap;">Prime Count</span>
    </td>
    <td class="timing_title">
      <span style="white-space: nowrap;">Segmented byte sieve</span><br/>
      <span class="cpu_details">Intel Core i7-6700, 3.4GHz, 32 KB L1 cache</span>
    </td>
    <td class="timing_title">
      <span style="white-space: nowrap;">Segmented bit sieve</span><br/>
      <span class="cpu_details">Intel Core i7-6700, 3.4GHz, 32 KB L1 cache</span>
    </td>
</tr>
<tr style="background-color: white">
    <td class="timing">10<sup>7</sup></td>
    <td class="timing">664,579</td>
    <td class="timing">0.03s</td>
    <td class="timing">0.03s</td>
</tr>
<tr>
    <td class="timing">10<sup>8</sup></td>
    <td class="timing">5,761,455</td>
    <td class="timing">0.11s</td>
    <td class="timing">0.11s</td>
</tr>
<tr style="background-color: white">
    <td class="timing">10<sup>9</sup></td>
    <td class="timing">50,847,534</td>
    <td class="timing">0.80s</td>
    <td class="timing">0.65s</td>
</tr>
<tr>
    <td class="timing">10<sup>10</sup></td>
    <td class="timing">455,052,511</td>
    <td class="timing">11.10s</td>
    <td class="timing">7.25s</td>
</tr>
<tr style="background-color: white">
    <td class="timing">10<sup>11</sup></td>
    <td class="timing">4,118,054,813</td>
    <td class="timing">141.88s</td>
    <td class="timing">88.47s</td>
</tr>
<tr>
    <td class="timing">10<sup>12</sup></td>
    <td class="timing">37,607,912,018</td>
    <td class="timing">1742.95s</td>
    <td class="timing">1104.00s</td>
</tr>
</table>

</section>

        <aside id="sidebar">
          <a href="https://github.com/kimwalisch/primesieve/zipball/master" class="download_button button">
            <small>Download</small>
            <span><noscript>Source .zip</noscript></span>
          </a>

          <!-- Inline iframe to speed up page loading -->
          <iframe frameborder="0" scrolling="0" style="width:170px; height: 30px;" src="github-star-button.html?user=kimwalisch&repo=primesieve&type=star&count=true&size=large" srcdoc="<html><body><style>body{padding:0;margin:0;font:700 11px/14px &#39;Helvetica Neue&#39;,Helvetica,Arial,sans-serif;overflow:hidden}.github-btn{height:20px;overflow:hidden}.gh-btn,.gh-count,.gh-ico{float:left}.gh-btn,.gh-count{padding:2px 5px 2px 4px;color:#333;text-decoration:none;text-shadow:0 1px 0 #fff;white-space:nowrap;cursor:pointer;border-radius:3px}.gh-btn{background-color:#eee;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#fcfcfc),color-stop(100%,#eee));background-image:-webkit-linear-gradient(top,#fcfcfc 0,#eee 100%);background-image:-moz-linear-gradient(top,#fcfcfc 0,#eee 100%);background-image:-ms-linear-gradient(top,#fcfcfc 0,#eee 100%);background-image:-o-linear-gradient(top,#fcfcfc 0,#eee 100%);background-image:linear-gradient(to bottom,#fcfcfc 0,#eee 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#fcfcfc&#39;, endColorstr=&#39;#eeeeee&#39;, GradientType=0);background-repeat:no-repeat;border:1px solid #d5d5d5}.gh-btn:focus,.gh-btn:hover{text-decoration:none;background-color:#ddd;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0,#eee),color-stop(100%,#ddd));background-image:-webkit-linear-gradient(top,#eee 0,#ddd 100%);background-image:-moz-linear-gradient(top,#eee 0,#ddd 100%);background-image:-ms-linear-gradient(top,#eee 0,#ddd 100%);background-image:-o-linear-gradient(top,#eee 0,#ddd 100%);background-image:linear-gradient(to bottom,#eee 0,#ddd 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=&#39;#eeeeee&#39;, endColorstr=&#39;#dddddd&#39;, GradientType=0);border-color:#ccc}.gh-btn:active{background-image:none;background-color:#dcdcdc;border-color:#b5b5b5;box-shadow:inset 0 2px 4px rgba(0,0,0,.15)}.gh-ico{width:14px;height:14px;margin-right:4px;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjQwcHgiIGhlaWdodD0iNDBweCIgdmlld0JveD0iMTIgMTIgNDAgNDAiIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMTIgMTIgNDAgNDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxwYXRoIGZpbGw9IiMzMzMzMzMiIGQ9Ik0zMiAxMy40Yy0xMC41IDAtMTkgOC41LTE5IDE5YzAgOC40IDUuNSAxNS41IDEzIDE4YzEgMC4yIDEuMy0wLjQgMS4zLTAuOWMwLTAuNSAwLTEuNyAwLTMuMiBjLTUuMyAxLjEtNi40LTIuNi02LjQtMi42QzIwIDQxLjYgMTguOCA0MSAxOC44IDQxYy0xLjctMS4yIDAuMS0xLjEgMC4xLTEuMWMxLjkgMC4xIDIuOSAyIDIuOSAyYzEuNyAyLjkgNC41IDIuMSA1LjUgMS42IGMwLjItMS4yIDAuNy0yLjEgMS4yLTIuNmMtNC4yLTAuNS04LjctMi4xLTguNy05LjRjMC0yLjEgMC43LTMuNyAyLTUuMWMtMC4yLTAuNS0wLjgtMi40IDAuMi01YzAgMCAxLjYtMC41IDUuMiAyIGMxLjUtMC40IDMuMS0wLjcgNC44LTAuN2MxLjYgMCAzLjMgMC4yIDQuNyAwLjdjMy42LTIuNCA1LjItMiA1LjItMmMxIDIuNiAwLjQgNC42IDAuMiA1YzEuMiAxLjMgMiAzIDIgNS4xYzAgNy4zLTQuNSA4LjktOC43IDkuNCBjMC43IDAuNiAxLjMgMS43IDEuMyAzLjVjMCAyLjYgMCA0LjYgMCA1LjJjMCAwLjUgMC40IDEuMSAxLjMgMC45YzcuNS0yLjYgMTMtOS43IDEzLTE4LjFDNTEgMjEuOSA0Mi41IDEzLjQgMzIgMTMuNHoiLz48L3N2Zz4=);background-size:100% 100%;background-repeat:no-repeat}.gh-count{position:relative;display:none;margin-left:4px;background-color:#fafafa;border:1px solid #d4d4d4}.gh-count:focus,.gh-count:hover{color:#4183C4}.gh-count:after,.gh-count:before{content:&#39;&#39;;position:absolute;display:inline-block;width:0;height:0;border-color:transparent;border-style:solid}.gh-count:before{top:50%;left:-3px;margin-top:-4px;border-width:4px 4px 4px 0;border-right-color:#fafafa}.gh-count:after{top:50%;left:-4px;z-index:-1;margin-top:-5px;border-width:5px 5px 5px 0;border-right-color:#d4d4d4}.github-btn-large{height:30px}.github-btn-large .gh-btn,.github-btn-large .gh-count{padding:3px 10px 3px 8px;font-size:16px;line-height:22px;border-radius:4px}.github-btn-large .gh-ico{width:20px;height:20px}.github-btn-large .gh-count{margin-left:6px}.github-btn-large .gh-count:before{left:-5px;margin-top:-6px;border-width:6px 6px 6px 0}.github-btn-large .gh-count:after{left:-6px;margin-top:-7px;border-width:7px 7px 7px 0}</style><span class=github-btn id=github-btn><a class=gh-btn id=gh-btn href=# target=_blank aria-label=&#34;&#34;><span class=gh-ico aria-hidden=true></span> <span class=gh-text id=gh-text></span></a> <a class=gh-count id=gh-count href=# target=_blank aria-label=&#34;&#34;></a></span><script>function addCommas(t){return String(t).replace(/(\d)(?=(\d{3})+$)/g,&#34;$1,&#34;)}function jsonp(t,e){var r=document.createElement(&#34;script&#34;);r.src=t+&#34;?callback=&#34;+(e?e:&#34;callback&#34;),head.insertBefore(r,head.firstChild)}function callback(t){switch(type){case&#34;watch&#34;:&#34;2&#34;===v?(counter.innerHTML=addCommas(t.data.subscribers_count),counter.setAttribute(&#34;aria-label&#34;,counter.innerHTML+&#34; watchers&#34;+labelSuffix)):(counter.innerHTML=addCommas(t.data.stargazers_count),counter.setAttribute(&#34;aria-label&#34;,counter.innerHTML+&#34; stargazers&#34;+labelSuffix));break;case&#34;star&#34;:counter.innerHTML=addCommas(t.data.stargazers_count),counter.setAttribute(&#34;aria-label&#34;,counter.innerHTML+&#34; stargazers&#34;+labelSuffix);break;case&#34;fork&#34;:counter.innerHTML=addCommas(t.data.network_count),counter.setAttribute(&#34;aria-label&#34;,counter.innerHTML+&#34; forks&#34;+labelSuffix);break;case&#34;follow&#34;:counter.innerHTML=addCommas(t.data.followers),counter.setAttribute(&#34;aria-label&#34;,counter.innerHTML+&#34; followers&#34;+labelSuffix)}&#34;true&#34;===count&&&#34;undefined&#34;!==counter.innerHTML&&(counter.style.display=&#34;block&#34;)}var params=function(){for(var t,e=[],r=window.location.href.slice(window.location.href.indexOf(&#34;?&#34;)+1).split(&#34;&&#34;),a=0;a<r.length;a++)t=r[a].split(&#34;=&#34;),e.push(t[0]),e[t[0]]=t[1];return e}(),user=&#39;kimwalisch&#39;,repo=&#39;primesieve&#39;,type=&#39;star&#39;,count=&#39;true&#39;,size=&#39;large&#39;,v=params.v,head=document.getElementsByTagName(&#34;head&#34;)[0],button=document.getElementById(&#34;gh-btn&#34;),mainButton=document.getElementById(&#34;github-btn&#34;),text=document.getElementById(&#34;gh-text&#34;),counter=document.getElementById(&#34;gh-count&#34;),labelSuffix=&#34; on GitHub&#34;;switch(button.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/&#34;,type){case&#34;watch&#34;:&#34;2&#34;===v?(mainButton.className+=&#34; github-watchers&#34;,text.innerHTML=&#34;Watch&#34;,counter.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/watchers&#34;):(mainButton.className+=&#34; github-stargazers&#34;,text.innerHTML=&#34;Star&#34;,counter.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/stargazers&#34;);break;case&#34;star&#34;:mainButton.className+=&#34; github-stargazers&#34;,text.innerHTML=&#34;Star&#34;,counter.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/stargazers&#34;;break;case&#34;fork&#34;:mainButton.className+=&#34; github-forks&#34;,text.innerHTML=&#34;Fork&#34;,button.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/fork&#34;,counter.href=&#34;https://github.com/&#34;+user+&#34;/&#34;+repo+&#34;/network&#34;;break;case&#34;follow&#34;:mainButton.className+=&#34; github-me&#34;,text.innerHTML=&#34;Follow @&#34;+user,button.href=&#34;https://github.com/&#34;+user,counter.href=&#34;https://github.com/&#34;+user+&#34;/followers&#34;}button.setAttribute(&#34;aria-label&#34;,text.innerHTML+labelSuffix),&#34;large&#34;===size&&(mainButton.className+=&#34; github-btn-large&#34;),jsonp(&#34;follow&#34;===type?&#34;https://api.github.com/users/&#34;+user:&#34;https://api.github.com/repos/&#34;+user+&#34;/&#34;+repo);</script>"></iframe>
          <p class="repo-owner" style="padding-top: 1.5em;">maintained by <a href="https://github.com/kimwalisch">kimwalisch</a></p>

          <p>The latest primesieve release is 6.3, see the
          <a href="https://github.com/kimwalisch/primesieve/blob/master/ChangeLog">ChangeLog</a>
          for what's new.</p>
        </aside>
      </div>
    </div>

    <script src="javascripts/jquery-3.3.1.slim.min.js"></script>
    <script src="javascripts/custom.min.js"></script>

  </body>
</html>
